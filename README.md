# KremenYA-Number-in-words
# ЧислоПрописью — Lambda-функция в Excel для написания числа прописью

**Синтаксис:**

ЧислоПрописью(Число;[Валюта])

**Аргументы:**

Число — обязательный аргумент; тип: действительное число, содержащее до пятнадцати цифр в целой и дробной частях.

Валюта — необязательный аргумент, может быть строкой или двумерным массивом определенной структуры и содержания (см. ниже).

**Примечания**

1. Если аргумент Валюта не указан, то в качестве валюты используется рубль для целой части и копейка для дробной части. Например, вызов функции ЧислоПрописью(1 234 567 890 123,45) возвращает значение: один триллион двести тридцать четыре миллиарда пятьсот шестьдесят семь миллионов восемьсот девяносто тысяч сто двадцать три рубля сорок пять копеек.

2. Аргумент Валюта может принимать следующие строковые значения: BYN, RUB, USD, EUR. 
Для значения BYN используется белорусский рубль для целой части и копейка для дробной части.
Для значения RUB используется российский рубль для целой части и копейка для дробной части.
Для значения USD используется доллар США для целой части и цент для дробной части.
Для значения EUR используется евро для целой части и евроцент для дробной части.

Например, вызов функции ЧислоПрописью(12 345,67; "USD") возвращает значение: двенадцать тысяч триста сорок пять долларов США шестьдесят семь центов.

3. Если в качестве аргумента указать строку, отличную от BYN, RUB, USD, EUR, то в качестве валюты используется рубль для целой части и копейка для дробной части. Например, вызов функции ЧислоПрописью(9 876,21; "QWERTY") возвращает значение: девять тысяч восемьсот семьдесят шесть рублей двадцать одна копейка.
 
4. Аргумент Валюта может быть двумерным массивом из двух строк и четырёх столбцов. Для краткости пояснений, обозначим этот массив буквой A.
Тогда, 

a[1,1] — строка, содержащая название валюты в целой части для единицы;

a[1,2] — строка, содержащая название валюты в целой части для двойки, тройки и четверки;

a[1,3] — строка, содержащая название валюты в целой части для любой другой цифры, отличной от единицы, двойки, тройки и четверки;

a[1,4] — строка из одного символа: м, ж, с, содержащая род целой части денежной единицы (мужской, женский и средний соответственно). Показывает как пишется единица и двойка в зависимости от рода денежной единицы. Например, единицу надо написать для женского рода как одна, для мужского — один, для среднего — одно, двойку — два (для мужского и среднего рода), две (для женского рода).

a[2,1] — строка, содержащая название валюты в дробной части для единицы;

a[2,2] — строка, содержащая название валюты в дробной части для двойки, тройки и четверки;

a[2,3] — строка, содержащая название валюты в дробной части для любой другой цифры, отличной от единицы, двойки, тройки и четверки;

a[2,4] — строка из одного символа: м, ж, с, содержащая род дробной части денежной единицы (мужской, женский и средний соответственно). Показывает как пишется единица и двойка в зависимости от рода денежной единицы. Например, единицу надо написать для женского рода как одна, для мужского — один, для среднего — одно, двойку — два (для мужского и среднего рода), две (для женского рода).

Например, вызов функции ЧислоПрописью(132,61; {"ворона"; "вороны"; "ворон"; "ж": "перо"; "пера"; "перьев"; "с"}) возвращает значение: сто тридцать две вороны шестьдесят одно перо.

Если в качестве аргумента Валюта указан не двумерный массив из двух строк и четырёх столбцов, то число возвращается в целых и сотых. 
Например, вызов функции ЧислоПрописью(132,61; {"ворона"; "вороны"; "ворон"; "ж"**;** "перо"; "пера"; "перьев"; "с"}) возвращает значение: сто тридцать две целых шестьдесят одна сотая. В данном примере в качестве аргумента Валюта передан одномерный массив из одной строки и восьми столбцов. 

# КлассПрописью — вспомогательная Lambda-функция в Excel, используется в основной функции КлассПрописью

КлассПрописью — вспомогательная Lambda-функция в Excel, необходимая для функции КлассПрописью, возникла из-за ограничения Диспетчера имён Excel на максимальную длину формулы (не более 2084 символа, включая пробелы). Поскольку функция носит вспомогательный характер и не планируется её самостоятельное использование, то здесь не приводится описание ни этой функции, ни параметров, необходимых для её вызова.

# МеняемВалюту — вспомогательная Lambda-функция в Excel, используется в основной функции КлассПрописью

МеняемВалюту — вспомогательная Lambda-функция в Excel, необходимая для функции КлассПрописью, возникла из-за ограничения Диспетчера имён Excel на максимальную длину формулы (не более 2084 символа, включая пробелы). Поскольку функция носит вспомогательный характер и не планируется её самостоятельное использование, то здесь не приводится описание ни этой функции, ни параметров, необходимых для её вызова.

# Важно

Для работы необходимо скопировать три функции: ЧислоПрописью, КлассПрописью, МеняемВалюту. Использовать только функцию ЧислоПрописью.
